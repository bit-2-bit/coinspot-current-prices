/*!
 * Display the latest Coinspot prices with jquery-coinspotCurrentPrices - v0.3.0 - 2015-04-11
 * https://github.com/bit-2-bit/coinspot-current-prices
 * Copyright (c) 2015 Dave Sag; Licensed MIT
 */

(function(){if("function"!=typeof jQuery)throw"Expected jQuery to have been loaded before this script."}).call(this),function(){!function(a){var b,c;return b=["bid","ask","last"],c=function(){function b(){}var c,d;return d=null,c=function(){function b(){this.url="https://www.coinspot.com.au/pubapi/latest",this.prices={},this.lastLoadTime=null,this.delay=6e4,this.loading=!1}return b.prototype.loadPrices=function(){var b,c,d,e,f;c=function(b){return function(c){var d;d=a.parseJSON(c.query.results.body),d&&"ok"===d.status?(b.prices=d.prices,b.lastLoadTime=new Date,a(document).trigger("price-change",[b.prices])):console.error("server returned",d)}}(this),d=function(a){console.error(a)},b=function(a){return function(){a.loading=!1,setTimeout(function(){return a.loadPrices()},a.delay)}}(this),!this.loading&&(null===this.lastLoadTime||this.lastLoadTime-1+this.delay<=new Date)&&(this.loading=!0,e=encodeURI("select * from html where url="),f="http://query.yahooapis.com/v1/public/yql?q="+e+'"'+this.url+'"&format=json&callback=?',a.getJSON(f).done(c).fail(d).always(b))},b}(),b.get=function(){return null!=d?d:d=new c},b}(),a.fn.coinspotCurrentPrices=function(){return this.loader=c.get(),this.loader.loadPrices(),this.each(function(){var c,d,e,f,g,h;if(c=a(this),h=c.is("input[type=text]"),d=c.data("currency"),f=c.data("price"),-1===b.indexOf(f))throw"invalid price field";return g=(e=c.data("margin"))?parseFloat(e):1,a(document).on("price-change",function(a,b){var e;e=parseFloat(b[d][f])*g,h?c.val(parseFloat(e.toFixed(6)).toString()):c.text(parseFloat(e.toFixed(6)).toString())}),c})}}(jQuery)}.call(this);
//# sourceMappingURL=jquery-coinspotCurrentPrices.0.3.0.min.js.map